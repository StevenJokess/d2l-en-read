

<!--
 * @version:
 * @Author:  StevenJokess https://github.com/StevenJokess
 * @Date: 2020-07-31 19:46:13
 * @LastEditors:  StevenJokess https://github.com/StevenJokess
 * @LastEditTime: 2020-09-19 20:57:37
 * @Description:MT, improve
 * @TODO::
 * @Reference:http://preview.d2l.ai/d2l-en/master/chapter_natural-language-processing-applications/natural-language-inference-and-dataset.html
-->

# 自然语言推理与数据集

在15.1节中，我们讨论了情绪分析的问题。该任务旨在将一个单一的文本序列分为预定义的类别，如一组情感极性。然而，当需要确定一个句子是否可以从另一个句子推断出来，或者通过确定语义上相等的句子来消除冗余时，知道如何对一个文本序列进行分类是不够的。相反，我们需要能够对成对的文本序列进行推理。

## 自然语言推理

自然语言推理研究一个假设是否可以从一个前提推断出来，其中两者都是一个文本序列。换句话说，自然语言推理决定了一对文本序列之间的逻辑关系。这种关系通常分为三种类型:

* 蕴涵: 假设可以从前提中推断出来。
* 矛盾: 对假设的否定可以从前提中推断出来。
* 中立: 所有其他情况。

自然语言推理也被称为识别/文字蕴涵任务。例如，下面的一对将被标记为蕴涵，因为在假设中“显示感情”可以从前提中的“相互拥抱”中推断出来。

* 前提: 两个女人拥抱在一起。
* 假设: 两个女人在表达爱意。

下面是一个矛盾的例子，因为“运行编码示例”表示“不睡觉”而不是“睡觉”。

* 前提: 一个人正在运行来自 Dive into Deep Learning 的编码示例。
* 假设: 这个人在睡觉。

第三个例子显示了一种中立关系，因为不能从”为我们表演”这一事实推断出”有名”或”不出名”。

* 前提: 音乐家为我们表演。
* 假设: 这些音乐家都很有名。

自然语言推理一直是理解自然语言的核心问题。它有着广泛的应用，从信息检索到开放领域的问题回答。为了研究这个问题，我们将从研究一个流行的自然语言推理基准数据集开始。

## 斯坦福自然语言推理(SNLI)数据集

斯坦福自然语言推理(SNLI)语料库是一个超过500,000500,000标记英语句子对的集合[ Bowman et al. ，2015]。我们在路径`./data/snli _ 1.0`中下载并存储提取的 SNLI 数据集。

TODO:CODE

## 读取数据集

最初的 SNLI 数据集包含了比我们在实验中真正需要的更丰富的信息。因此，我们定义了一个 `read _ snli` 函数来只提取数据集的一部分，然后返回前提、假设及其标签的列表。

TODO:CODE

现在让我们打印前3对前提和假设，以及它们的标签(“0”、“1”和“2”分别对应“entailment”、 “contradiction”和“neutral”)。

TODO:CODE

训练集大约有55,000对，测试集大约有10,000对。由下可知，“隐含”、“矛盾”、“中性”这三个标签在训练集和测试集中都是平衡的。

TODO:CODE

## 定义装入数据集的类

下面我们定义一个类，通过继承Gluon中的数据集类来加载SNLI数据集。类构造函数中的参数`num_steps`指定文本序列的长度，以便每个小批序列具有相同的形状。换句话说，在较长的序列中，在第一个num_steps之后的标记将被修剪，而特殊的标记“<pad>”将被附加到较短的序列中，直到它们的长度变为`num_steps`。通过实现剩余的`__getitem__`函数，我们可以任意访问前提、假设，并使用索引`idx`进行标记。

TODO:CODE

## 把所有东西放在一起

现在我们可以调用`read_snli`函数和`SNLIDataset`类下载SNLI数据集和返回`DataLoader`实例对训练集和测试集,与训练集的词汇。值得注意的是我们必须使用的词汇构造训练集与测试集。因此,任何新的令牌从测试组将未知模型在训练集上训练。

TODO:CODE

这里，我们将批处理大小设置为128，序列长度设置为50，并调用`load_data_snli`函数来获得数据迭代器和词汇表。然后我们打印词汇量大小。

TODO:CODE

现在我们打印第一个小批量的形状。与情绪分析相反，我们有X[0]和X[1]2个输入，分别代表一对前提和假设。

TODO:CODE

## 小结

* 自然语言推理研究假设是否可以从一个前提中推断出来，前提和假设都是一个文本序列。
* 在自然语言推理中，前提与假设的关系包括隐含关系、矛盾关系、中和关系。
* 斯坦福自然语言推理(SNLI)语料库是一种流行的自然语言推理基准数据集。

## 练习

1. 机器翻译长期以来都是基于输出翻译和ground truth翻译之间的表面n-gram匹配来评价的。你能用自然语言推理设计一种衡量机器翻译结果的方法吗?
1. 如何更改超参数来减小词汇表的大小?
