

<!--
 * @version:
 * @Author:  StevenJokes https://github.com/StevenJokes
 * @Date: 2020-07-30 18:49:09
 * @LastEditors:  StevenJokes https://github.com/StevenJokes
 * @LastEditTime: 2020-07-30 19:03:26
 * @Description:
 * @TODO::
 * @Reference:http://preview.d2l.ai/d2l-en/master/chapter_computer-vision/ssd.html
-->

# 单镜头多盒检测(SSD)

在前面的几节中，我们介绍了包围盒、锚定盒、多尺度目标检测和数据集。现在，我们将利用这些背景知识来构建一个目标检测模型: 单镜头多盒检测(SSD)[ Liu et al. ，2016]。这种快速简便的模式已经得到广泛应用。这个模型的一些设计概念和实现细节也适用于其他的目标检测模型。

图13.7.1显示了 SSD 模型的设计。该模型的主要组成部分是一个基本网络块和多个多尺度特征块串联在一起。在这里，基本网络块用于提取原始图像的特征，它通常采用深卷积神经网络的形式。关于 ssd 的论文选择在分类层之前放置一个截断的 VGG [ Liu 等人，2016] ，但是现在通常被 ResNet 所取代。我们可以设计基本网络，使其输出更大的高度和宽度。通过这种方式，基于这个特征映射生成更多的定位框，使我们能够检测到更小的对象。接下来，每个多尺度特征块减少前一层提供的特征映射的高度和宽度(例如，它可以减少一半的大小)。然后块使用特征映射中的每个元素来扩展输入图像上的感受域。这样，一个多尺度特征块越接近图13.7.1的顶部，它的输出特征映射就越小，基于特征映射生成的定位框就越少。此外，特征块越接近顶部，特征映射中每个元素的感受域就越大，也就越适合于探测较大的物体。由于 SSD 根据基本网络块和每个多尺度特征块生成不同大小的锚定盒数目，然后预测锚定盒的类别和偏移量(即预测的包围盒) ，以便检测不同大小的对象，SSD 是一个多尺度目标检测模型。

图13.7.1 SSD 由一个基本网络块和几个串联的多尺度特征块组成。

接下来，我们将描述图13.7.1中模块的实现。首先，我们需要讨论类别预测和包围盒预测的实现。

将对象类别的数量设置为 q。在这种情况下，锚定框类别的数量是 q + 1 q + 1,0表示只包含背景的锚定框。对于某个比例尺，将特征映射的高度和宽度分别设置为 h h 和 w。如果我们使用每个元素作为中心生成一个锚箱，我们需要分类的总华锚箱。如果我们使用一个完全连接的层(FCN)作为输出，这可能会导致过多的模型参数。回想一下我们在7.3节中是如何使用卷积层通道来输出类别预测的。SSD 使用相同的方法来降低模型的复杂性。

具体来说，类别预测层使用一个卷积层来维护输入高度和宽度。因此，输出和输入沿着特征映射的宽度和高度与空间坐标之间有一个双射。假设输出和输入具有相同的空间坐标(x，y)(x，y) ，输出特征映射上的坐标(x，y)(x，y)通道包含使用输入特征映射坐标(x，y)(x，y)作为中心生成的所有锚定框的类别预测。因此，存在一个(q + 1) a (q + 1)输出通道，其输出通道为 i (q + 1) + j i (q + 1) + j (0≤ j ≤ q 0≤ j ≤ q) ，表示锚箱索引 i 的类索引 j 的预测值。

现在，我们将定义这种类型的类别预测层。在我们指定了参数 a 和 q q 之后，它使用了一个3333卷积层，内边距为1。这个回旋层的输入和输出的高度和宽度保持不变。

TODO:CODE

当物体相对于图像较大时，模型通常采用较大的输入图像大小。

在标记锚框类别时，这通常会产生大量负的锚框。我们可以对负锚框进行采样，以更好地平衡数据类别。为此，我们可以设置MultiBoxTarget函数的negative_mining_ratio参数。

在损失函数中为锚盒类别损失和正锚盒偏移损失分配不同权重的超参数。

参考SSD文件。什么方法可以用来评估目标检测模型的精度[Liu et al.， 2016]?
