

<!--
 * @version:
 * @Author:  StevenJokes https://github.com/StevenJokes
 * @Date: 2020-07-14 23:22:07
 * @LastEditors:  StevenJokes https://github.com/StevenJokes
 * @LastEditTime: 2020-09-10 22:09:36
 * @Description:MT
 * @TODO::
 * @Reference:
-->

# Kaggle 上的图像分类(CIFAR-10)

到目前为止，我们一直在使用 Gluon 的数据包直接获得张量格式的图像数据集。然而，在实践中，图像数据集常常以图像文件的格式存在。在本节中，我们将从原始图像文件开始，一步一步地组织、读取和转换这些文件为张量格式。

我们在13.1节中对 CIFAR-10数据集进行了实验。这是计算机视觉领域的一个重要数据集。现在，我们将应用我们在前面章节中学到的知识来参加 Kaggle 竞赛，这个竞赛解决了 CIFAR-10图像分类问题。比赛的网址是

https://www.kaggle.com/c/cifar-10

图13.13.1展示了本次比赛网页的信息。为了提交结果，请先在Kaggle网站注册一个账号。

图13.13.1 CIFAR-10图像分类竞赛网页资料。您可以点击“ Data”选项卡访问比赛的数据集。

首先，导入竞赛所需的软件包或模块。

TODO:CODE

我们将选择模型并根据模型在验证集上的性能来调整超参数。接下来，我们定义模型训练功能训练。我们记录每个时期的训练时间，这有助于我们比较不同模型的时间成本。

TODO:CODE


## 获取和组织数据集

将比赛数据分为训练集和测试集。训练集包含50,000到50,000张图片。测试套件包含300000300000张图像，其中1000010000张图像用于评分，另外290000290000张图像包含在内，以防止测试套件的手动标记和提交标记结果。两个数据集中的图像格式都是 PNG 格式，高度和宽度为32像素和三色通道(RGB)。这些图片涵盖了1010个类别: 飞机、汽车、鸟类、猫、鹿、狗、青蛙、马、船和卡车。图9.16的左上角显示了数据集中的一些飞机、汽车和鸟类的图像。

## 训练和验证模型

现在，我们可以训练和验证模型。可以调整以下超参数。例如，我们可以增加时期数。因为lr_period和lr_decay分别设置为80和0.1，所以每80个周期后，优化算法的学习率将乘以0.1。为了简单起见，我们在这里只训练一个时期。

CIFAR-10图像分类挑战使用10个类别。在训练开始之前，我们将对模型执行Xavier随机初始化。

TODO:CODE

## 定义训练函数

我们将选择模型并根据模型在验证集上的性能来调整超参数。接下来，我们定义模型训练功能训练。我们记录每个时期的训练时间，这有助于我们比较不同模型的时间成本。

TODO:CODE

## 对测试集进行分类并在Kaggle上提交结果

在得到满意的模型设计和超参数后，我们使用所有的训练数据集(包括验证集)对模型进行再训练，对测试集进行分类。

TODO:CODE

执行以上代码后，会得到一个“submission”。csv文件。此文件的格式与Kaggle竞赛要求一致。提交结果的方法类似于4.10节中的方法。
:numref:sec_kaggle_house

## 小结

* 我们可以创建一个`ImageFolderDataset`实例来读取包含原始图像文件的数据集。
* 我们可以使用卷积神经网络、图像增强和混合编程来参加图像分类竞赛。

## 练习

1. 将完整的CIFAF-10数据集用于Kaggle竞赛。将batch_size和纪元数num_epochs分别更改为128和100。看看您在这场比赛中可以达到的准确性和排名。
1. 不使用图像增强时可以达到什么精度？
1. 扫描QR码以访问相关讨论，并就社区使用的方法和获得的结果交换意见。您能提出更好的技术吗？
