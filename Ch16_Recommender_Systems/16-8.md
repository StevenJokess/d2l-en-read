

<!--
 * @version:
 * @Author:  StevenJokess https://github.com/StevenJokess
 * @Date: 2020-07-31 17:44:13
 * @LastEditors:  StevenJokess https://github.com/StevenJokess
 * @LastEditTime: 2020-07-31 17:48:50
 * @Description:MT
 * @TODO::
 * @Reference:http://preview.d2l.ai/d2l-en/master/chapter_recommender-systems/ctr.html
-->

# 富特征的推荐系统

互动数据是用户偏好和兴趣的最基本指标。它在以前介绍的模型中起着至关重要的作用。但是，交互数据通常非常稀疏，有时可能会很嘈杂。为了解决此问题，我们可以将辅助信息（例如项目的功能，用户的个人资料，甚至是在发生交互的情况下）整合到推荐模型中。利用这些功能有助于做出建议，因为这些功能可以有效地预测用户的兴趣，尤其是在缺少交互数据时。因此，至关重要的是推荐模型还必须具有处理这些功能并赋予模型一些内容/上下文意识的能力。为了演示这种类型的推荐模型，我们为在线广告推荐引入了另一项有关点击率（CTR）的任务[McMahan等，2013]，并提供了匿名广告数据。有针对性的广告服务已经引起了广泛的关注，并且通常被构造为推荐引擎。推荐符合用户个人品味和兴趣的广告对于提高点击率至关重要。

数字营销人员利用在线广告向客户展示广告。点击率是衡量广告客户在每一次点击中收到的点击量的指标，用百分比表示，计算公式如下:

TODO:MATH

数字营销人员使用在线广告向客户显示广告。点击率是一种度量广告客户的广告获得的点击次数/展示次数的指标，它表示为使用以下公式计算得出的百分比：

TODO:CODE

## 在线广告数据集

随着互联网和移动技术的飞速发展，在线广告已成为互联网行业重要的收入来源，并成为互联网行业绝大部分收入的来源。重要的是要展示相关的广告或能引起用户兴趣的广告，这样偶然的访问者就能转化为付费用户。我们介绍的数据集是一个在线广告数据集。它由34个字段组成，第一列表示目标变量，指示是否点击了一个广告(1)或没有点击(0)，其他所有列都是分类特征。这些列可能表示广告id、站点或应用程序id、设备id、时间、用户配置文件等。由于匿名化和隐私问题，这些特性的真实语义尚未公开。

以下代码从我们的服务器下载数据集，并将其保存到本地数据文件夹中。

TODO:CODE

有一个训练集和一个测试集，分别有15000和3000个样本/行。


## 数据集包装

为了方便数据加载，我们实现了一个CTRDataset，它从CSV文件加载广告数据集，并且可以由DataLoader使用。

以下示例加载训练数据并打印出第一条记录。

TODO:CODE

可以看出，所有34个字段都是分类特征。每个值表示对应条目的一个热索引。标签00表示它没有被单击。这个CTRDataset也可以用来加载其他数据集，如Criteo显示广告挑战数据集和Avazu点击通过率预测数据集。

## 小结

点击率是衡量广告系统和推荐系统有效性的重要指标。

点击率预测通常转化为二分类问题。目标是根据给定的特性来预测一个广告/项目是否会被点击。

## 练习

1. 您可以加载Criteo和Avazu数据集与提供的CTRDataset。值得注意的是，Criteo数据集由实值特性组成，所以您可能需要稍微修改代码。
